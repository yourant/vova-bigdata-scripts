---
config:
  failure.emails: andy.zhang@vova.com.hk
  retries: 100
  retry.backoff: 120000

nodes:
  - name: end_flag
    type: command
    config:
      command: echo "stop job"
    dependsOn:
      - rpt_market_export
      - rpt_market_1_export
      - rpt_main_process_export
      - rpt_rec_report_all_export
#      - rpt_rec_report_active_export
      - rpt_ab_test_export_ab
      - rpt_ab_test_export_gcr
      - rpt_min_price_goods
      - rpt_market_step_2_web_export
      - rpt_market_step_2_superset_export
      - rpt_web_main_process
      - rpt_brand_goods
      - rpt_quality_control_core_tag
      - rpt_quality_control_delivered
      - rpt_quality_control_redund
      - rpt_quality_control_shipments
      - rpt_airyclub_ads_brief
      - rpt_payment
      - rpt_goods_cat
      - rpt_goods_cat_export
      - rpt_rec_report_active_export
      - rpt_coupon

  - name: start_flag
    type: command
    config:
      command: echo "start job"

  - name: judge_fact_cart_cause_v2
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/ods/judge_check.sh fact_cart_cause_v2
    dependsOn:
      - start_flag

  - name: judge_fact_order_cause_v2
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/ods/judge_check.sh fact_order_cause_v2
    dependsOn:
      - start_flag

  - name: judge_dim_order_goods
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/ods/judge_check.sh dim_order_goods
    dependsOn:
      - start_flag

  - name: rpt_market
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/rpt/market/update_final.sh
      retries: 5
      retry.backoff: 600000
    dependsOn:
      - judge_fact_pay
      - judge_fact_start_up
      - judge_dim_devices
      - judge_fact_activity_order_goods

  - name: rpt_market_export
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/rpt/market/update_final_export.sh
      retries: 5
      retry.backoff: 600000
    dependsOn:
      - rpt_market

  - name: rpt_market_step_2
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/rpt/market/update_final_2.sh
      retries: 5
      retry.backoff: 600000
    dependsOn:
      - rpt_market

  - name: rpt_market_step_2_superset_export
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/rpt/market/update_final_2_superset_export.sh
      retries: 5
      retry.backoff: 600000
    dependsOn:
      - rpt_market_step_2

  - name: rpt_market_step_2_web_export
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/rpt/market/update_final_2_web_export.sh
      retries: 5
      retry.backoff: 600000
    dependsOn:
      - rpt_market_step_2

  - name: rpt_market_1
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/rpt/market_1/update_final.sh
      retries: 5
      retry.backoff: 600000
    dependsOn:
      - judge_fact_pay
      - judge_fact_start_up
      - judge_dim_devices

  - name: rpt_market_1_export
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/rpt/market_1/update_final_export.sh
      retries: 5
      retry.backoff: 600000
    dependsOn:
      - rpt_market_1

  - name: judge_fact_pay
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/ods/judge_check.sh fact_pay
    dependsOn:
      - start_flag

  - name: judge_dim_devices
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/ods/judge_check.sh dim_devices
    dependsOn:
      - start_flag

  - name: judge_fact_start_up
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/ods/judge_check.sh fact_start_up
    dependsOn:
      - start_flag

  - name: judge_fact_log_goods_click
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/ods/judge_check.sh fact_log_goods_click
    dependsOn:
      - start_flag

  - name: judge_fact_log_goods_impression
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/ods/judge_check.sh fact_log_goods_impression
    dependsOn:
      - start_flag

  - name: rpt_main_process
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/rpt/main_process/update.sh
      retries: 5
      retry.backoff: 600000
      job.priority: 10
    dependsOn:
      - judge_dim_devices
      - judge_dim_order_goods
      - judge_fact_pay
      - judge_fact_log_screen_view
      - judge_fact_log_common_click
      - judge_fact_log_order_process
      - judge_fact_buyer_device_releation
      - judge_fact_activity_order_goods

  - name: rpt_main_process_export
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/rpt/main_process/update_export.sh
      retries: 5
      retry.backoff: 600000
      job.priority: 10
    dependsOn:
      - rpt_main_process

  - name: rpt_ab_test_export_ab
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/rpt/ab_test/update_export_ab.sh
      retries: 5
      retry.backoff: 600000
    dependsOn:
      - rpt_ab_test

  - name: rpt_ab_test_export_gcr
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/rpt/ab_test/update_export_gcr.sh
      retries: 5
      retry.backoff: 600000
    dependsOn:
      - rpt_ab_test

  - name: rpt_ab_test
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/rpt/ab_test/update.sh
      retries: 5
      retry.backoff: 600000
      job.priority: 10
    dependsOn:
      - judge_fact_ab

  - name: judge_fact_ab
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/ods/judge_check.sh fact_ab
    dependsOn:
      - start_flag


  - name: rpt_goods_cat
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/rpt/goods_cat/update.sh
      retries: 5
      retry.backoff: 600000
    dependsOn:
      - judge_fact_log_goods_impression
      - judge_fact_log_goods_click
      - judge_fact_log_common_click
      - judge_dim_goods
      - judge_fact_pay
      - judge_fact_order_cause_v2

  - name: rpt_goods_cat_export
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/rpt/goods_cat/update_export.sh
      retries: 5
      retry.backoff: 600000
    dependsOn:
      - rpt_goods_cat


  - name: judge_fact_log_screen_view
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/ods/judge_check.sh fact_log_screen_view
    dependsOn:
      - start_flag

  - name: judge_fact_log_common_click
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/ods/judge_check.sh fact_log_common_click
    dependsOn:
      - start_flag

  - name: judge_fact_log_order_process
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/ods/judge_check.sh fact_log_order_process
    dependsOn:
      - start_flag

  - name: judge_fact_logistics
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/ods/judge_check.sh fact_logistics
    dependsOn:
      - start_flag

  - name: judge_vova_shipping_carrier
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/ods/judge_check.sh vova_shipping_carrier
    dependsOn:
      - start_flag

  - name: judge_vova_collection_order_goods
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/ods/judge_check.sh collection_order_goods
    dependsOn:
      - start_flag

  - name: judge_fact_refund
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/ods/judge_check.sh fact_refund
    dependsOn:
      - start_flag

  - name: judge_vova_checkout_chargeback_reporting
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/ods/judge_check.sh vova_checkout_chargeback_reporting
    dependsOn:
      - start_flag

  - name: judge_vova_order_goods_extension
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/ods/judge_check.sh vova_order_goods_extension
    dependsOn:
      - start_flag

  - name: rpt_rec_report
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/rpt/rec_report/update.sh
      retries: 5
      retry.backoff: 600000
    dependsOn:
      - judge_dim_devices
      - judge_fact_log_goods_click
      - judge_fact_log_goods_impression
      - judge_fact_cart_cause_v2
      - judge_fact_order_cause_v2
      - judge_dim_order_goods
      - judge_fact_pay

  - name: rpt_rec_report_all_export
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/rpt/rec_report/update_export_all.sh
      retries: 5
      retry.backoff: 600000
    dependsOn:
      - rpt_rec_report


  - name: judge_fact_buyer_device_releation
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/ods/judge_check.sh fact_buyer_device_releation
    dependsOn:
      - start_flag

  - name: judge_fact_activity_order_goods
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/ods/judge_check.sh fact_activity_order_goods
    dependsOn:
      - start_flag

  - name: judge_dim_goods
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/ods/judge_check.sh dim_goods
    dependsOn:
      - start_flag

  - name: judge_vova_order_goods_status
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/ods/judge_check.sh vova_order_goods_status
    dependsOn:
      - start_flag


  - name: rpt_min_price_goods
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/rpt/min_price_goods/update.sh
      retries: 5
      retry.backoff: 600000
    dependsOn:
      - judge_dim_goods
      - judge_fact_pay
      - judge_fact_log_goods_impression


  - name: rpt_quality_control_core_tag
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/rpt/quality_control/update.sh
      retries: 5
      retry.backoff: 600000
    dependsOn:
      - judge_fact_pay
      - judge_fact_logistics
      - judge_vova_shipping_carrier
      - judge_vova_collection_order_goods
      - judge_fact_refund
      - judge_dim_order_goods
      - judge_vova_checkout_chargeback_reporting
      - judge_vova_order_goods_extension

  - name: judge_fact_web_start_up
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/ods/judge_check.sh fact_web_start_up
    dependsOn:
      - start_flag

  - name: judge_fact_log_page_view
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/ods/judge_check.sh fact_log_page_view
    dependsOn:
      - start_flag

  - name: judge_fact_log_impressions
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/ods/judge_check.sh fact_log_impressions
    dependsOn:
      - start_flag

  - name: rpt_web_main_process
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/rpt/web_main_process/update.sh
      retries: 5
      retry.backoff: 600000
    dependsOn:
      - judge_fact_web_start_up
      - judge_fact_log_page_view
      - judge_fact_log_impressions
      - judge_fact_log_common_click
      - judge_fact_pay
      - judge_dim_order_goods

  - name: rpt_brand_goods
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/rpt/brand_goods/update.sh
      retries: 5
      retry.backoff: 600000
    dependsOn:
      - judge_fact_pay
      - judge_dim_goods
      - judge_fact_log_goods_impression

  - name: rpt_quality_control_delivered
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/rpt/quality_control/update_delivered.sh
      retries: 5
      retry.backoff: 600000
    dependsOn:
      - judge_fact_pay
      - judge_fact_logistics
      - judge_vova_shipping_carrier
      - judge_vova_order_goods_status
      - judge_dim_order_goods


  - name: rpt_quality_control_redund
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/rpt/quality_control/update_refund.sh
      retries: 5
      retry.backoff: 600000
    dependsOn:
      - judge_fact_pay
      - judge_fact_logistics
      - judge_fact_refund
      - judge_vova_order_goods_status
      - judge_vova_order_goods_extension
      - judge_dim_order_goods

  - name: judge_vova_order_info
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/ods/judge_check.sh vova_order_info
    dependsOn:
      - start_flag

  - name: judge_vova_region
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/ods/judge_check.sh vova_region
    dependsOn:
      - start_flag


  - name: judge_vova_order_shipping_tracking
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/ods/judge_check.sh vova_order_shipping_tracking
    dependsOn:
      - start_flag


  - name: rpt_quality_control_shipments
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/rpt/quality_control/update_shipments.sh
      retries: 5
      retry.backoff: 600000
    dependsOn:
      - judge_dim_order_goods
      - judge_vova_order_info
      - judge_vova_region
      - judge_dim_goods
      - judge_vova_order_goods_status
      - judge_vova_order_shipping_tracking
      - judge_vova_collection_order_goods
      - judge_fact_logistics
      - judge_vova_shipping_carrier
      - judge_fact_logistics



  - name: judge_vova_adwords_ad_carousel
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/ods/judge_check.sh vova_adwords_ad_carousel
    dependsOn:
      - start_flag

  - name: judge_vova_adwords_ad_performance_daily_report
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/ods/judge_check.sh vova_adwords_ad_performance_daily_report
    dependsOn:
      - start_flag

#  - name: judge_vova_campaign_adgroup_mapping
#    type: command
#    config:
#      command: sh /mnt/vova-bd-scripts/ods/judge_check.sh vova_campaign_adgroup_mapping
#      retries: 5
#      retry.backoff: 600000
#    dependsOn:
#      - start_flag

  - name: judge_vova_campaign_mapping
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/ods/judge_check.sh vova_campaign_mapping
    dependsOn:
      - start_flag

  - name: judge_vova_ads_ga_channel_daily_gmv_flat_report
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/ods/judge_check.sh vova_ads_ga_channel_daily_gmv_flat_report
    dependsOn:
      - start_flag

  - name: judge_vova_ads_ga_channel_daily_flat_report
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/ods/judge_check.sh vova_ads_ga_channel_daily_flat_report
    dependsOn:
      - start_flag

  - name: rpt_airyclub_ads_brief
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/rpt/airyclub_ads_brief/update.sh
      retries: 5
      retry.backoff: 600000
    dependsOn:
      - judge_vova_adwords_ad_carousel
      - judge_vova_adwords_ad_performance_daily_report
#      - judge_vova_campaign_adgroup_mapping
      - judge_vova_ads_ga_channel_daily_gmv_flat_report
      - judge_vova_ads_ga_channel_daily_flat_report
      - judge_vova_campaign_mapping

  - name: rpt_payment
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/rpt/payment/update_history.sh
      retries: 3
      retry.backoff: 600000
    dependsOn:
      - rpt_payment_error_code

  - name: rpt_payment_error_code
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/rpt/payment/tmp_code_update.sh
      retries: 3
      retry.backoff: 600000
    dependsOn:
      - judge_dim_order_goods
      - judge_fact_log_common_click
      - judge_fact_pay

  - name: rpt_rec_report_active_export
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/rpt/rec_report/update_export_active.sh
      retries: 5
      retry.backoff: 600000
    dependsOn:
      - rpt_rec_active_report

  - name: rpt_rec_active_report
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/rpt/rec_report/update_active.sh
      retries: 5
      retry.backoff: 600000
      job.priority: 10
    dependsOn:
      - rpt_rec_report


  - name: rpt_coupon
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/rpt/coupon/update.sh
      retries: 5
      retry.backoff: 600000
    dependsOn:
      - judge_dim_buyers
      - judge_dim_coupon
      - judge_fact_pay

  - name: judge_dim_buyers
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/ods/judge_check.sh dim_buyers
    dependsOn:
      - start_flag

  - name: judge_dim_coupon
    type: command
    config:
      command: sh /mnt/vova-bd-scripts/ods/judge_check.sh dim_coupon
    dependsOn:
      - start_flag