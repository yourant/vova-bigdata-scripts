---
config:
  failure.emails: yunling@i9i8.com
  retries: 8
  retry.backoff: 180000

nodes:
  - name: fd_dw_ods_dim_full_start
    type: noop

  - name: category_table
    type: flow
    config:
      prop: value
    nodes:
      - name: category_start
        type: noop

      - name: judge_category
        type: command
        config:
          command: sh /mnt/vova-bigdata-scripts/common/judge_check.sh category ${dt}
        dependsOn:
          - category_start

      - name: ods_category
        type: command
        config:
          command: sh /mnt/vova-bigdata-scripts/fd/ods/full_table/category/run.sh ${dt}
        dependsOn:
          - judge_category

      - name: dim_category
        type: command
        config:
          command: sh /mnt/vova-bigdata-scripts/fd/dim/run.sh dim_category ${dt}
        dependsOn:
          - ods_category
    dependsOn:
      - fd_dw_ods_dim_full_start

  - name: currency_table
    type: flow
    config:
      prop: value
    nodes:
      - name: currency_start
        type: noop

      - name: judge_currency
        type: command
        config:
          command: sh /mnt/vova-bigdata-scripts/common/judge_check.sh currency ${dt}
        dependsOn:
          - currency_start

      - name: ods_currency
        type: command
        config:
          command: sh /mnt/vova-bigdata-scripts/fd/ods/full_table/currency/run.sh ${dt}
        dependsOn:
          - judge_currency

      - name: dim_currency
        type: command
        config:
          command: sh /mnt/vova-bigdata-scripts/fd/dim/run.sh dim_currency ${dt}
        dependsOn:
          - ods_currency
    dependsOn:
      - fd_dw_ods_dim_full_start

  - name: goods_table
    type: flow
    config:
      prop: value
    nodes:
      - name: goods_start
        type: noop

      - name: judge_goods
        type: command
        config:
          command: sh /mnt/vova-bigdata-scripts/common/judge_check.sh goods ${dt}
        dependsOn:
          - goods_start

      - name: ods_goods
        type: command
        config:
          command: sh /mnt/vova-bigdata-scripts/fd/ods/full_table/goods/run.sh ${dt}
        dependsOn:
          - judge_goods

      - name: judge_dim_category
        type: command
        config:
          command: sh /mnt/vova-bigdata-scripts/common/judge_check.sh dim_category ${dt}
        dependsOn:
          - ods_goods

      - name: judge_dim_virtual_goods
        type: command
        config:
          command: sh /mnt/vova-bigdata-scripts/common/judge_check.sh dim_virtual_goods ${dt}
        dependsOn:
          - ods_goods

      - name: dim_goods
        type: command
        config:
          command: sh /mnt/vova-bigdata-scripts/fd/dim/run.sh dim_goods ${dt}
        dependsOn:
          - judge_dim_category
          - judge_dim_virtual_goods
    dependsOn:
      - fd_dw_ods_dim_full_start

  - name: languages_table
    type: flow
    config:
      prop: value
    nodes:
      - name: languages_start
        type: noop

      - name: judge_languages
        type: command
        config:
          command: sh /mnt/vova-bigdata-scripts/common/judge_check.sh languages ${dt}
        dependsOn:
          - languages_start

      - name: ods_languages
        type: command
        config:
          command: sh /mnt/vova-bigdata-scripts/fd/ods/full_table/languages/run.sh ${dt}
        dependsOn:
          - judge_languages

      - name: dim_language
        type: command
        config:
          command: sh /mnt/vova-bigdata-scripts/fd/dim/run.sh dim_language ${dt}
        dependsOn:
          - ods_languages
    dependsOn:
      - fd_dw_ods_dim_full_start

  - name: region_table
    type: flow
    config:
      prop: value
    nodes:
      - name: region_start
        type: noop

      - name: judge_region
        type: command
        config:
          command: sh /mnt/vova-bigdata-scripts/common/judge_check.sh region ${dt}
        dependsOn:
          - region_start

      - name: ods_region
        type: command
        config:
          command: sh /mnt/vova-bigdata-scripts/fd/ods/full_table/region/run.sh ${dt}
        dependsOn:
          - judge_region

      - name: dim_region
        type: command
        config:
          command: sh /mnt/vova-bigdata-scripts/fd/dim/run.sh dim_region ${dt}
        dependsOn:
          - ods_region
    dependsOn:
      - fd_dw_ods_dim_full_start

  - name: user_agent_analysis_table
    type: flow
    config:
      prop: value
    nodes:
      - name: user_agent_analysis_start
        type: noop

      - name: judge_ods_user_agent_analysis
        type: command
        config:
          command: sh /mnt/vova-bigdata-scripts/common/judge_check.sh ods_user_agent_analysis ${dt}
        dependsOn:
          - user_agent_analysis_start

      - name: dim_user_agent
        type: command
        config:
          command: sh /mnt/vova-bigdata-scripts/fd/dim/run.sh dim_user_agent ${dt}
        dependsOn:
          - judge_ods_user_agent_analysis
          
    dependsOn:
      - fd_dw_ods_dim_full_start

  - name: virtual_goods_table
    type: flow
    config:
      prop: value
    nodes:
      - name: virtual_goods_start
        type: noop

      - name: judge_virtual_goods
        type: command
        config:
          command: sh /mnt/vova-bigdata-scripts/common/judge_check.sh virtual_goods ${dt}
        dependsOn:
          - virtual_goods_start

      - name: ods_virtual_goods
        type: command
        config:
          command: sh /mnt/vova-bigdata-scripts/fd/ods/full_table/virtual_goods/run.sh ${dt}
        dependsOn:
          - judge_virtual_goods

      - name: dim_virtual_goods
        type: command
        config:
          command: sh /mnt/vova-bigdata-scripts/fd/dim/run.sh dim_virtual_goods ${dt}
        dependsOn:
          - ods_virtual_goods
    dependsOn:
      - fd_dw_ods_dim_full_start 

  - name: fd_dw_ods_dim_full_end
    type: noop
    dependsOn:
      - category_table
      - currency_table
      - goods_table
      - languages_table
      - region_table
      - user_agent_analysis_table
      - virtual_goods_table
